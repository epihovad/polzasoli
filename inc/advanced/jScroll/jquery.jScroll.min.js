(function(b){var f={init:function(){b(this).each(function(){var a=b(this);a.parents(".jScroll_ar:first").length&&f.destroy.call(a);var d=a.attr("h");if(!d||a.height()<d)return!0;a.attr("del")&&a.find("div").css({"padding-top":0,"padding-bottom":0});a.prepend('<div class="pad clear"></div>').append('<div class="pad clear"></div>');var e=a.width(),n=a.get(0).scrollHeight,i=a.attr("tb"),i=i?" "+i:"",j=b('<div class="jScroll_ar"></div>'),o=b('<div class="jScroll_top'+i+'"></div>'),i=b('<div class="jScroll_bot'+ i+'"></div>'),k=b('<div class="jScroll_rp"></div>'),g=b('<div class="jScroll_roller"><div class="ru"></div><div class="rm"></div><div class="rb"></div></div>');j.height(d);a.css({height:d,overflow:"hidden"});a.wrap(j);o.add(i).width(e);var j=d-32,p=a.attr("rp");k.css({margin:"16px 0 0 "+(e-10+(p?1*p:0))+"px"}).height(j);e=d*j/n;g.height(e);g.find(".rm").height(e-4);k.append(g);a.before(k).before(o).after(i);a.get(0).scrollTop=0;var q=(n-d+32)/(j-e),r=5*d/100,l=0,m=1*(k.height()-g.height());a.height(); g.height();g.draggable({containment:k,axis:"y",drag:function(b,d){var h=d.position.top;if(0>h)return g.css("top",0),setTimeout(function(){a.scrollTop(0)},100),!1;a.scrollTop(h*q);l=h}});a.mousewheel(function(d,b){var h=void 0,h=h?h:r,c=a.scrollTop();a.scrollTop(c-b*h);var e=a.scrollTop();0>e||(e?c==e?(g.css({top:m}),l=m):(c=l,c-=b*h/q,0>c?c=0:c&&1>c?c=1:c>m&&(c=m),g.css({top:c}),l=c):(l=0,g.css({top:0})));return!1})})},redraw:function(){$jScroll=b(this);if($jScroll.parents(".jScroll_ar:first").length)f.destroy.call($jScroll), f.init.call($jScroll);else return f.init.call($jScroll),!1},destroy:function(){$jScroll=b(this);var a=$jScroll.parents(".jScroll_ar:first");if(!a.length)return!1;var d=a.find(".jScroll_top"),e=a.find(".jScroll_bot"),f=a.find(".jScroll_rp");f.find(".jScroll_roller").draggable("destroy");d.add(e).add(f).remove();$jScroll.unwrap(a).css({padding:"0",height:"auto"}).unbind("mousewheel");$jScroll.find("div.pad").remove()}};b.fn.jScroll=function(a){if(f[a])return f[a].apply(this,Array.prototype.slice.call(arguments, 1));if("object"===typeof a||!a)return f.init.apply(this,arguments)}})(jQuery);
(function(b){var c,n,q,r,f,e,m,t,u,s,v,h,p={init:function(a){c=b('<div id="jPop"></div>');q=b('<div id="jPop_head"><div></div></div>');r=b('<div id="jPop_footer"><div></div></div>');n=b('<a id="jPop_close" class="inline" href=""></a>');f=b('<div id="jPop_cont"></div>');e=b('<div id="jPop_ind"><img src="/inc/advanced/jPop/img/ind.gif" width="31" height="31"></div>');m=b('<div id="jPop_shadow"></div>');c.prepend(r).prepend(f).prepend(q).prepend(n).prepend(e);b("body").prepend(c);h=b.browser.msie?parseInt(b.browser.version): !1;9<h&&(h=!1);h&&b("body").prepend(m);n.click(function(){p.hide.call();return!1});b(window).resize(function(){p.repos.call()});b(document).mousewheel(function(a){c.is(":visible")&&(b(a.currentTarget).parents(c).size()||a.preventDefault())})},show:function(a){a=b.extend({title:"",footer:"",pos:"center",ws:!0,ws_params:{opacity:50,z:zmax?zmax:999},z:zmax?zmax+1:1E3,callback:function(){}},a);c.size()||p.init.call();if(!a.url&&!a.data)return!1;a.callback&&n.click(function(){a.callback.call()});a.title? q.find("div").html(a.title):q.height(0);a.footer&&(r.find("div").html(a.footer),r.addClass("act"));var d,g,k,l;if(c.is(":visible")){d=a.w;g=a.h;l=k=0;switch(a.pos){default:case "center":k=Math.round(b("body").width()/2-d/2+b(window).scrollLeft());l=Math.round(b("body").height()/2-g/2+b(window).scrollTop());break;case "top":k=Math.round(b("body").width()/2-d/2+b(window).scrollLeft()),l=Math.round(b(window).scrollTop()+20)}f.html("");f.css({width:d-30,height:g-35-(a.title?48:0)-(a.footer?48:0)});indL= Math.round(d/2-e.width()/2);indT=Math.round(g/2-e.height()/2);n.css("margin","16px 0 0 "+(d-30)+"px");e.css("margin",indT+"px 0 0 "+indL+"px");h&&m.hide();c.animate({width:d,height:g,left:k,top:l},300,function(){e.show();a.url?f.load(a.url,function(){e.hide()}):a.data&&(e.hide(),f.html(a.data));h&&m.css({width:d,height:g,left:k-4,top:l-4,"z-index":parseInt(c.css("z-index"))-2}).show()})}else{u=a.pos;s=a.ws;v=a.ws_params;c.css({width:a.w?a.w:Math.round(b("body").width()/2),height:a.h?a.h:Math.round(b("body").height()/ 2),"z-index":a.z});h||c.css("-moz-border-radius","20px");d=c.width();g=c.height();l=k=0;switch(a.pos){default:case "center":k=Math.round(b("body").width()/2-d/2+b(window).scrollLeft());l=Math.round(b("body").height()/2-g/2+b(window).scrollTop());break;case "top":k=Math.round(b("body").width()/2-d/2+b(window).scrollLeft()),l=Math.round(b(window).scrollTop()+20)}c.css({left:k,top:l});f.css({width:d-30,height:g-35-(a.title?48:0)-(a.footer?48:0)});indL=Math.round(d/2-e.width()/2);indT=Math.round(g/2- e.height()/2);n.css("margin","16px 0 0 "+(d-30)+"px");e.css("margin",indT+"px 0 0 "+indL+"px");s&&(t=b(document).jB("show",v));c.show();h&&m.css({width:d,height:g,left:k-4,top:l-4,"z-index":parseInt(c.css("z-index"))-2}).show();a.url?f.load(a.url,function(){e.hide()}):a.data&&(e.hide(),f.html(a.data));zmax&&(zmax+=2)}},hide:function(a){c.add(m).hide();s&&t.jB("hide");f.html("");e.show()},resize:function(a,d){a=b.extend({w:0,h:0,pos:"center"},a);windW=a.w?a.w:c.width();windH=a.h?a.h:c.height();windT= windL=0;switch(a.pos){default:case "center":windL=Math.round(b("body").width()/2-windW/2+b(window).scrollLeft());windT=Math.round(b("body").height()/2-windH/2+b(window).scrollTop());break;case "top":windL=Math.round(b("body").width()/2-windW/2+b(window).scrollLeft()),windT=Math.round(b(window).scrollTop()+20)}h&&m.hide();f.animate({width:windW-30,height:windH-35-(a.title?48:0)-(a.footer?48:0)},300);n.hide();c.animate({width:windW,height:windH,left:windL,top:windT},300,"linear",function(){n.css("margin", "16px 0 0 "+(windW-30)+"px");h&&m.css({width:windW,height:windH,left:windL-4,top:windT-4,"z-index":parseInt(c.css("z-index"))-2}).show();d&&d.call()})},repos:function(){var a=Math.round(b("body").width()/2-c.width()/2+b(window).scrollLeft()),d=0;switch(u){default:case "center":d=Math.round(b("body").height()/2-c.height()/2+b(window).scrollTop());break;case "top":d=Math.round(b(window).scrollTop()+20)}c.css({left:a,top:d});m.css({left:a-4,top:d-4})}};b.fn.jPop=function(a){if(p[a])return p[a].apply(this, Array.prototype.slice.call(arguments,1));if("object"===typeof a||!a)return p.init.apply(this,arguments)}})(jQuery);$(function(){$(document).jPop()});